<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- original version: 25496 -->

 <sect1 condition="bootable-usb" id="boot-usb-files">
 <title>Préparation des fichiers pour un amorçage avec une clé USB</title>

<para>

Pour préparer une clé USB, vous avez besoin d'un système GNU/Linux fonctionnel
et qui accepte les périphériques USB. Vérifiez que le module du noyau
usb-storage est chargé (<userinput>modprobe usb-storage</userinput>) et trouvez
à quel périphérique SCSI la clé USB est attribuée (dans cet exemple, c'est
<filename>/dev/sda</filename>). Pour pouvoir écrire sur la clé, il vous faudra
sans doute enlever la protection contre l'écriture.
</para>
<para>

Notez que la taille de la clé doit être au moins de 128&nbsp;Mo. Pour des
tailles inférieures, voyez <xref linkend="usb-copy-flexible"/>.

</para>

  <sect2 id="usb-copy-easy">
  <title>Copie des fichiers &mdash; la méthode simple</title>
<para arch="i386">

Le fichier <filename>hd-media/boot.img.gz</filename> contient tous les
fichiers de l'installateur, le noyau et le programme 
<command>SYSLINUX</command> avec son fichier de configuration. Il vous suffit
d'extraire ces fichiers dans votre clé USB&nbsp;:

<informalexample><screen>
# zcat boot.img.gz &gt; /dev/<replaceable>sda</replaceable>
</screen></informalexample>

Bien sûr toutes les données présentes sur la clé seront détruites. Utilisez
le bon périphérique pour votre clé&nbsp;!
</para>
<para arch="powerpc">

Le fichier <filename>hd-media/boot.img.gz</filename> contient tous les
fichiers de l'installateur, le noyau et le programme
<command>yaboot</command> avec son fichier de configuration. Créez une 
partition <quote>Apple_Bootstrap</quote> sur la clé avec la commande 
<userinput>C</userinput> de <command>mac-fdisk</command> et mettez l'image
avec&nbsp;:

<informalexample><screen>
# zcat boot.img.gz &gt; /dev/<replaceable>sda2</replaceable>
</screen></informalexample>


Bien sûr toutes les données présentes sur la clé seront détruites. Utilisez
le bon périphérique pour votre clé&nbsp;!
</para>
<para>

Montez ensuite la clé (<userinput>mount 
<replaceable arch="i386">/dev/sda</replaceable>
<replaceable arch="powerpc">/dev/sda2</replaceable>
/mnt</userinput>), qui aura
maintenant un système de fichiers 
<phrase arch="i386">FAT</phrase>
<phrase arch="powerpc">HFS</phrase>, et copiez une image ISO de type
netinst ou businesscard. Le nom de ce fichier doit se terminer par
<filename>.iso</filename>. Démontez la clé (<userinput>umount /mnt</userinput>)
et voilà, c'est fait&nbsp;!
</para>
</sect2>

  <sect2 id="usb-copy-flexible">
  <title>Copie des fichiers &mdash; la méthode souple</title>
<para>

Si vous aimez la souplesse ou si vous voulez simplement savoir ce qui se
passe, vous pouvez utiliser la méthode suivante pour mettre les fichiers
sur la clé. 
</para>

&usb-setup-i386.xml;
&usb-setup-powerpc.xml;

<sect3>
<title>Ajouter une image ISO</title>
<para>

Vous pouvez maintenant mettre une image ISO (businesscard, netinst ou même
l'image complète) sur la clé. Le nom de cette image doit se terminer par
<filename>.iso</filename>.

</para>
<para>

Si vous voulez faire une installation sur le réseau, sans utiliser d'image
ISO, vous sauterez bien sûr l'étape précédente. De plus vous devrez utiliser
le disque virtuel initial qui se trouve dans le répertoire
<filename>netboot</filename> au lieu de celui dans le répertoire
<filename>hd-media</filename>, car le fichier 
<filename>hd-media/initrd.gz</filename> n'a aucun support pour le réseau.

</para>
<para>

Quand tout est fait, démontez la clé USB (<userinput>umount /mnt</userinput>) 
et activez la protection contre l'écriture.

</para>
</sect3>

<!-- TODO: doesn't this section belong later? -->
<sect3 arch="i386">
   <title>Amorcer la clé USB</title>
<warning><para>

Si le système refuse de s'amorcer à partir de la clé, il se peut que la clé
possède un secteur principal d'amorçage défectueux. Corrigez-le avec le
programme <command>install-mbr</command> qui se trouve dans le paquet
<classname>mbr</classname>&nbsp;:

<informalexample><screen>
# install-mbr /dev/<replaceable>sda</replaceable>
</screen></informalexample>

</para></warning>
</sect3>
  </sect2>
 </sect1>
